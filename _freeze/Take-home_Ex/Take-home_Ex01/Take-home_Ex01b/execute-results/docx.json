{
  "hash": "d8b84c7e1b439c165bc99fc6a59b075a",
  "result": {
    "markdown": "---\ntitle: \"Take-home Exercise 1 - Phrase 2: <br>Peer Review and Makeover \"\ndescription: \"\"\ndate: \"2025-05-10\"\n# date-modified: \"\"\nformat: docx\neditor: visual\nauthor: \"Li Jianyi\"\nexecute:\n  eval: true #- Run the code and show the result.\n  echo: true #- Show the code in the output.\n  warning: false\n  freeze: true\n---\n\n\n<!-- ::: callout-note -->\n\n<!-- ```{r} -->\n\n<!-- #| code-fold: false -->\n\n<!-- #| code-summary: \"Click to view code\" -->\n\n<!-- ``` -->\n\n<!-- ::: -->\n\n<br> <br>\n\n## **Peer Review of [Yuan Yihao](https://isss-608-yihao-yuan.netlify.app/take-home_ex/take-home_ex01/take-home_ex01)'s Take-home Exercise 1 - Phrase 2**\n\n### **1. Overview of [Yihao’s Work](https://isss-608-yihao-yuan.netlify.app/take-home_ex/take-home_ex01/take-home_ex01) and Data Preparation**\n\n[Yihao’s take-home exercise](https://isss-608-yihao-yuan.netlify.app/take-home_ex/take-home_ex01/take-home_ex01) investigates Singapore’s 2024 demographic structure through three visualisations:\n\n1.  Population by Age and Sex\n\n2.  Population by Age Group and Planning Area\n\n3.  Aging-to-Under-Age Population Ratio by Planning Area\n\nThese charts aim to explore gender imbalances across age groups, assess regional aging patterns, and evaluate the relative burden of aging populations.\n\nFor this peer review, I will focus on the first two visualisations only — Population by Age and Sex, and Population by Age Group and Planning Area — as they demonstrate distinct perspectives on demographic segmentation and regional trends.\n\nYihao’s data preparation is methodical and well-documented. The dataset was imported using `read_csv()` from the Department of Statistics Singapore. Key preprocessing steps include converting Age and Pop to numeric, recoding `\"90_and_Over\" to \"90\"`, and verifying missing values using `colSums(is.na(...))`. These steps provide a clean and structured foundation for subsequent visual analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\npacman::p_load(ggiraph, plotly, \n               patchwork, DT, tidyverse) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nres_data <- read_csv(\"data/data.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nres_data %>% filter(if_any(everything(), is.na))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 0 × 6\n# ℹ 6 variables: PA <chr>, SZ <chr>, Age <chr>, Sex <chr>, Pop <dbl>,\n#   Time <dbl>\n```\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\ncolSums(is.na(res_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  PA   SZ  Age  Sex  Pop Time \n   0    0    0    0    0    0 \n```\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nres_data <- res_data %>%\n  mutate(Age = ifelse(Age == \"90_and_Over\", \"90\", Age),\n         Age = as.numeric(Age)) \n\nstr(res_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [60,424 × 6] (S3: tbl_df/tbl/data.frame)\n $ PA  : chr [1:60424] \"Ang Mo Kio\" \"Ang Mo Kio\" \"Ang Mo Kio\" \"Ang Mo Kio\" ...\n $ SZ  : chr [1:60424] \"Ang Mo Kio Town Centre\" \"Ang Mo Kio Town Centre\" \"Ang Mo Kio Town Centre\" \"Ang Mo Kio Town Centre\" ...\n $ Age : num [1:60424] 0 0 1 1 2 2 3 3 4 4 ...\n $ Sex : chr [1:60424] \"Males\" \"Females\" \"Males\" \"Females\" ...\n $ Pop : num [1:60424] 10 10 10 10 10 10 10 10 30 10 ...\n $ Time: num [1:60424] 2024 2024 2024 2024 2024 ...\n```\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nres_data <- res_data %>%\n  mutate(\n    Age = as.numeric(Age),\n    Pop = as.numeric(Pop)\n  )\nstr(res_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [60,424 × 6] (S3: tbl_df/tbl/data.frame)\n $ PA  : chr [1:60424] \"Ang Mo Kio\" \"Ang Mo Kio\" \"Ang Mo Kio\" \"Ang Mo Kio\" ...\n $ SZ  : chr [1:60424] \"Ang Mo Kio Town Centre\" \"Ang Mo Kio Town Centre\" \"Ang Mo Kio Town Centre\" \"Ang Mo Kio Town Centre\" ...\n $ Age : num [1:60424] 0 0 1 1 2 2 3 3 4 4 ...\n $ Sex : chr [1:60424] \"Males\" \"Females\" \"Males\" \"Females\" ...\n $ Pop : num [1:60424] 10 10 10 10 10 10 10 10 30 10 ...\n $ Time: num [1:60424] 2024 2024 2024 2024 2024 ...\n```\n:::\n:::\n\n\n### **2. Exploratory Visual Analysis**\n\n### **EVA 1: Population by Age and Sex**\n\nStrengths:\n\n1.  Innovative Visual Encoding\n\n    Yihao’s use of layered colored bars over a grey baseline to compare male and female populations by age is a creative and effective technique. It visually emphasizes gender differences in a way that is immediately understandable.\n\n2.  Clear Trend Identification\n\n    The chart successfully highlights a demographic pattern: males dominate in younger age groups (0–30), while females outnumber males in older age bands (30–90+). This is both accurately computed and clearly observed in the visual.\n\n3.  Efficient Data Transformation\n\n    The process of reshaping the data using pivot_wider() and calculating male_extra and female_extra is handled cleanly. This preprocessing step sets the stage for the layered visualisation approach.\n\n::: panel-tabset\n## original code\n\n\n::: {.cell Eval='false'}\n\n```{.r .cell-code  code-summary=\"Click to view code\"}\nlibrary(dplyr)\nlibrary(ggplot2)\n\n\ngrouped_data <- res_data %>%\n  group_by(Age, Sex) %>%\n  summarise(Pop = sum(Pop, na.rm = TRUE), .groups = \"drop\")\n\n\nwide_data <- grouped_data %>%\n  pivot_wider(names_from = Sex, values_from = Pop, values_fill = 0) %>%\n  mutate(\n    min_pop = pmin(Males, Females),\n    male_extra = ifelse(Males > Females, Males - Females, 0),\n    female_extra = ifelse(Females > Males, Females - Males, 0)\n  )\n\n\nggplot() +\n\n  geom_col(data = wide_data, aes(x = Age, y = min_pop), \n           fill = \"gray70\", width = 0.6) +\n\n\n  geom_col(data = wide_data, aes(x = Age, y = male_extra), \n           fill = \"steelblue\", width = 0.6) +\n\n\n  geom_col(data = wide_data, aes(x = Age, y = female_extra), \n           fill = \"tomato\", width = 0.6) +\n\n  labs(\n    title = \"Population by Age and Sex\",\n    x = \"Age\",\n    y = \"Population\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01b_files/figure-docx/unnamed-chunk-4-1.png)\n:::\n:::\n\n\n## Makeover code\n\n\n::: {.cell Eval='false'}\n\n```{.r .cell-code  code-summary=\"Click to view code\"}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(scales)      \nlibrary(viridisLite) \n\ngrouped_data <- res_data %>%\n  group_by(Age, Sex) %>%\n  summarise(Pop = sum(Pop, na.rm = TRUE), .groups = \"drop\")\n\nwide_data <- grouped_data %>%\n  pivot_wider(names_from = Sex, values_from = Pop, values_fill = 0) %>%\n  mutate(\n    min_pop = pmin(Males, Females),\n    male_extra = ifelse(Males > Females, Males - Females, 0),\n    female_extra = ifelse(Females > Males, Females - Males, 0)\n  )\n\nggplot() +\n  geom_col(data = wide_data, aes(x = Age, y = min_pop), \n           fill = \"grey80\", width = 0.6) +\n\n  geom_col(data = wide_data, aes(x = Age, y = male_extra), \n           fill = viridis(3)[1], width = 0.6) +\n\n  geom_col(data = wide_data, aes(x = Age, y = female_extra), \n           fill = viridis(3)[3], width = 0.6) +\n\n  labs(\n    title = \"Population by Age and Sex (2024)\",\n    subtitle = \"Grey = shared population, Blue = Male surplus, Yellow = Female surplus\",\n    x = \"Age\",\n    y = \"Population Count\",\n    caption = \"Data: Singapore Department of Statistics (June 2024)\"\n  ) +\n  scale_y_continuous(labels = comma) +\n  theme_minimal(base_size = 12) +\n  theme(\n    plot.subtitle = element_text(size = 10, margin = margin(b = 10)),\n    plot.caption = element_text(size = 8)\n  )\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01b_files/figure-docx/unnamed-chunk-5-1.png)\n:::\n:::\n\n\n## Makeover Chart\n\nThis chart shows the relative percentage of male and female residents across each age group. The data was first grouped by age and sex, then the population in each sex group was divided by the total population in that age to compute the gender composition.\n\nUnlike the earlier visual (which showed raw population differences), this version uses a normalized scale (0–100%). It allows readers to clearly see which age groups are more gender-balanced and where one gender dominates in proportion — regardless of actual size.\n\n::: {.callout- title=\"Insight\"}\n-   Ages 0–29 show a slight male majority, indicating male-dominant birth cohorts or younger male migration.\n\n-   From age 30 onwards, females increasingly dominate, especially beyond age 60 — a pattern consistent with higher female life expectancy.\n\n-   The crossover point — where the female proportion begins to exceed male — occurs around age 30, reinforcing the findings from the earlier absolute comparison chart.\n\nThis proportional view enhances the demographic story by highlighting gender imbalance dynamics relative to each age group, useful for understanding long-term trends in healthcare demand and social support planning.\n:::\n\n\n::: {.cell Eval='false'}\n\n```{.r .cell-code  code-summary=\"Click to view code\"}\ncomposition_data <- res_data %>%\n  group_by(Age, Sex) %>%\n  summarise(Pop = sum(Pop, na.rm = TRUE), .groups = \"drop\") %>%\n  group_by(Age) %>%\n  mutate(Percent = Pop / sum(Pop)) %>%\n  ungroup()\n\n\nggplot(composition_data, aes(x = Age, y = Percent, fill = Sex)) +\n  geom_col(position = \"fill\", width = 0.8) +\n  scale_fill_manual(values = c(\"Males\" = \"#1f77b4\", \"Females\" = \"#ff7f0e\")) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  labs(\n    title = \"Gender Composition by Age Group (2024)\",\n    subtitle = \"Proportion of males and females across each age\",\n    x = \"Age\",\n    y = \"Percentage\",\n    fill = \"Gender\",\n    caption = \"Data: Singapore Department of Statistics (June 2024)\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    plot.subtitle = element_text(size = 10, margin = margin(b = 10)),\n    plot.caption = element_text(size = 8)\n  )\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01b_files/figure-docx/unnamed-chunk-6-1.png)\n:::\n:::\n\n:::\n\n::: {.callout-note title=\"Suggestions for Improvement\"}\n1.  Add a Clear Legend or Annotation\n\n    While the color scheme is intuitive (steelblue for males, tomato for females), the chart lacks a legend or explicit note explaining what the colors represent. Adding a legend would enhance interpretability.\n\n2.  Enhance Visual Accessibility\n\n    Consider using a color-blind friendly palette or patterns to differentiate between the bars. This ensures accessibility for all readers.\n\n3.  Include a Normalized Comparison Option\n\n    While the visual shows absolute differences, adding a secondary visual or facet that presents percentage distribution by age group (e.g., % males vs. % females per age) could provide additional analytical value.\n:::\n\n### **EVA 2: Population by Age Group and Planning Area**\n\nStrengths:\n\n1.  Clear Age Segmentation Strategy\n\n    Yihao categorizes age into three intuitive groups — Under Age, Adult, and Aging. This simplifies the analysis and allows for high-level comparisons across planning areas.\n\n2.  Clean and Readable Bar Chart Design\n\n    The horizontal bar chart layout, with planning areas on the y-axis, is a smart choice for comparing numerous geographic areas. The ordering of bars by population supports fast scanning of highest and lowest regions.\n\n3.  Additional Ratio Analysis\n\n    Yihao extends the analysis beyond counts by calculating the Aging-to-Under-Age Ratio, offering deeper insights into demographic pressure. This demonstrates good analytical thinking beyond surface-level observations.\n\n::: panel-tabset\n## original code\n\n\n::: {.cell Eval='false'}\n\n```{.r .cell-code  code-summary=\"Click to view code\"}\nres_data_grouped <- res_data %>%\n  mutate(AgeGroup = case_when(\n    Age >= 0 & Age <= 20 ~ \"Under Age\",\n    Age >= 21 & Age <= 60 ~ \"Adult\",\n    Age >= 61 ~ \"Aging\"\n  )) %>%\n  group_by(PA, AgeGroup) %>%\n  summarise(Pop = sum(Pop, na.rm = TRUE), .groups = \"drop\")\n\nres_data_grouped_filtered <- res_data_grouped %>%\n  filter(AgeGroup != \"Adult\")\n\nggplot(res_data_grouped_filtered, aes(x = Pop, y = reorder(PA, Pop), fill = AgeGroup)) +\n  geom_col(position = position_dodge(width = 0.9), width = 0.4) +\n  labs(\n    title = \"Population by Age Group and Planning Area\",\n    x = \"Population\",\n    y = \"Planning Area\",\n    fill = \"Age Group\"\n  ) +\n  scale_y_discrete(expand = expansion(mult = c(0.4, 0.4))) + \n  theme_minimal() +\n  theme(\n    axis.text.y = element_text(size = 3, margin = margin(r = 5)), \n    legend.position = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01b_files/figure-docx/unnamed-chunk-7-1.png)\n:::\n:::\n\n\n## Makeover code\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Click to view code\"}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(scales)\n\nres_data_grouped <- res_data %>%\n  mutate(\n    AgeGroup = case_when(\n      Age <= 14 ~ \"Youth\",\n      Age >= 65 ~ \"Elderly\",\n      TRUE ~ \"Working\"\n    )\n  ) %>%\n  group_by(PA, AgeGroup) %>%\n  summarise(Pop = sum(Pop, na.rm = TRUE), .groups = \"drop\") %>%\n  filter(!is.na(PA), !is.na(AgeGroup))\n\npa_top25 <- res_data_grouped %>%\n  group_by(PA) %>%\n  summarise(Total = sum(Pop)) %>%\n  arrange(desc(Total)) %>%\n  slice_head(n = 25) %>%\n  pull(PA)\n\nres_data_percent <- res_data_grouped %>%\n  filter(PA %in% pa_top25) %>%\n  group_by(PA) %>%\n  mutate(Percent = Pop / sum(Pop)) %>%\n  ungroup()\n\nelderly_order <- res_data_percent %>%\n  filter(AgeGroup == \"Elderly\") %>%\n  arrange(desc(Percent)) %>%\n  pull(PA)\n\nres_data_percent$PA <- factor(res_data_percent$PA, levels = elderly_order)\n\nggplot(res_data_percent, aes(x = PA, y = Percent, fill = AgeGroup)) +\n  geom_col(width = 0.8) +\n  coord_flip() +\n  scale_y_continuous(labels = percent_format(accuracy = 1)) +\n  scale_fill_manual(values = c(\"Youth\" = \"#66c2a5\", \"Working\" = \"#fc8d62\", \"Elderly\" = \"#8da0cb\")) +\n  labs(\n    title = \"Age Group Composition by Planning Area (Top 25 by Population)\",\n    subtitle = \"Filtered and sorted by Elderly Population Share\",\n    x = \"Planning Area\",\n    y = \"Percentage of Total Population\",\n    fill = \"Age Group\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    axis.text.y = element_text(size = 9),\n    legend.position = \"top\",\n    plot.subtitle = element_text(size = 9),\n    plot.margin = margin(10, 10, 10, 10)\n  )\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01b_files/figure-docx/unnamed-chunk-8-1.png)\n:::\n:::\n\n:::\n\n::: {.callout-note title=\"Suggestions for Improvement\"}\n-   Refined Age Group Boundaries\n\n    Age categories were updated to follow standard definitions:\n\nYouth: 0–14\n\nWorking: 15–64\n\nElderly: 65+ This ensures alignment with demographic research and public policy frameworks.\n\n-   Improved Visual Readability\n\n    The chart was filtered to show only the top 25 most populated planning areas to reduce clutter. Font size for axis labels was increased (size = 9) and coord_flip() was applied to present the labels horizontally, improving label legibility.\n\n-   Incorporated Proportional Representation\n\n    Instead of plotting absolute values, the chart now shows percentage composition by age group using a 100% stacked bar format. This enables fairer comparison across areas with different total population sizes and highlights structural age group differences.\n\n-   Reordered Planning Areas by Elderly Share\n\n    The bars were sorted based on the proportion of elderly residents in each area, which strengthens the narrative focus and draws attention to aging population hotspots.\n\n-   Applied Colorblind-Friendly Palette\n\n    Manual color selection was updated using a palette suitable for broader accessibility, improving visual contrast between age groups.\n:::\n\n### **References**\n\n- [Yuan Yihao](https://isss-608-yihao-yuan.netlify.app/take-home_ex/take-home_ex01/take-home_ex01)\n- [Take-home exercise 1](https://isss608-ay2024-25apr.netlify.app/th_ex/th_ex1)\n",
    "supporting": [
      "Take-home_Ex01b_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}